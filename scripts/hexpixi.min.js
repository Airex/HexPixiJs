(function(n,t){"use strict";var i=n.HexPixi=n.HexPixi||{};i.CoordinateSystems=[{name:"odd-q",isFlatTop:!0,isOdd:!0},{name:"even-q",isFlatTop:!0,isOdd:!1},{name:"odd-r",isFlatTop:!1,isOdd:!0},{name:"even-r",isFlatTop:!1,isOdd:!1}],i.TerrainTypes=[{name:"empty",moveMod:0,color:16777215},{name:"brown",moveMod:0,color:9127187},{name:"grasst1",moveMod:0,textureIndex:0}],i.Cell=function(n,t,i){var r=this;r.row=n,r.column=t,r.center={x:0,y:0},r.terrainIndex=i?i:0,r.text=new PIXI.Text("1",{font:"10px Arial",fill:0})},i.Map=function(n,r){function s(n){var t=new PIXI.Sprite(u.textures[i.TerrainTypes[n.terrainIndex].textureIndex]);t.position.x=n.center.x,t.position.y=n.center.y,t.anchor.x=.5,t.anchor.y=.5,u.hexes.addChild(t)}function h(n,t,r,u){var f=n*2,o=Math.round(Math.sqrt(3)/2*f),h=Math.round(3/4*f),s=o,l=i.CoordinateSystems[u],e={x:0,y:0,width:f,height:o},c;return l.isFlatTop?(c=l.isOdd?0:1,e.x=t*h+f/2,e.y=(t+c)%2?r*s+s/2:r*s+s):(o=n*2,f=Math.round(Math.sqrt(3)/2*o),h=f,s=Math.round(3/4*o),e.y=r*s+o/2,c=l.isOdd?1:0,e.x=(r+c)%2?t*h+f/2:t*h+f),e}function f(n){var t=u.options.hexSize*2,r=Math.sqrt(3)/2*t;n.center=h(u.options.hexSize,n.column,n.row,u.options.coordinateSystem),n.text.setText(n.column.toString()+", "+n.row.toString()),n.text.position.x=Math.round(n.center.x-n.text.width/2),n.text.position.y=Math.round(n.center.y-r/2+4),i.TerrainTypes[n.terrainIndex].textureIndex>=0?s(n):u.drawHex(u.hexes,u.options.hexSize,n)}function c(){u.textures=[],u.textures.push(new PIXI.Texture.fromImage("/images/game/hex_grass01.png"))}function e(i){u.options=t.extend(!0,{},o,i),u.pixiStage==null&&(u.pixiStage=n),u.container.addChild(u.hexes),u.pixiStage.addChild(u.container),u.hexes.clear(),u.hexes.lineStyle(u.options.hexLineWidth,u.options.hexLineColor,1),c()}var u=this,o={coordinateSystem:1,mapWidth:10,mapHeight:10,hexSize:40,hexSizeHeightRatio:1,hexLineColor:9474192,hexLineWidth:1,zoomLevel:1};u.textures=[],u.hexes=new PIXI.Graphics,u.container=new PIXI.DisplayObjectContainer,u.pixiStage=null,u.options=null,u.cells=[],u.drawHex=function(n,t,r){var e=t,o=0,l=i.CoordinateSystems[u.options.coordinateSystem],c=l.isFlatTop?0:.5,f=Math.PI/3*c,s=r.center.x+e*Math.cos(f),h=r.center.y+e*Math.sin(f),a=i.TerrainTypes[r.terrainIndex].color?i.TerrainTypes[r.terrainIndex].color:16777215;for(n.beginFill(a),n.moveTo(Math.round(s),Math.round(h)),o=1;o<7;o++)f=Math.PI/3*(o+c),s=r.center.x+e*Math.cos(f),h=r.center.y+e*Math.sin(f),n.lineTo(Math.round(s),Math.round(h));n.endFill()},u.reset=function(n){while(u.cells.length>0){while(u.cells[0].length>0)u.cells[0].splice(0,1);u.cells.splice(0,1)}while(u.hexes.children.length)u.hexes.removeChild(u.hexes.children[0]);while(u.container.children.length>0)u.container.removeChildAt(0);u.pixiStage.removeChild(u.container),e(n)},u.generateRandomMap=function(){for(var t,e,r,n=0;n<u.options.mapHeight;n++)for(u.cells[n]=[],t=0;t<u.options.mapWidth;t++)e=Math.floor(Math.random()*i.TerrainTypes.length),r=new i.Cell(n,t,e),f(r),u.cells[n].push(r),u.hexes.addChild(r.text)},u.generateBlankMap=function(){for(var t,r,n=0;n<u.options.mapHeight;n++)for(u.cells[n]=[],t=0;t<u.options.mapWidth;t++)r=new i.Cell(n,t,0),f(r),u.cells[n].push(r),u.hexes.addChild(r.text)},e(r)}})(window,jQuery)